angular.module("pancakesAngular",[]),"#_=_"===window.location.hash&&(history.replaceState?history.replaceState(null,null,window.location.href.split("#")[0]):window.location.hash=""),angular.module("pancakesAngular").factory("activeUser",function(){return{}}),angular.module("pancakesAngular").factory("ajax",["$q","$http","eventBus","config","storage",function(n,e,t,r,a){function o(o,u,i,c){var l,s,f=n.defer(),g=[];o=r.apiBase+o,i=i||{};var d=i.data;delete i.data,o.indexOf("{_id}")>=0?i._id?(o=o.replace("{_id}",i._id),delete i._id):d&&d._id&&(o=o.replace("{_id}",d._id)):"GET"===u&&i._id&&(o+="/"+i._id,delete i._id);var p=i.showErr!==!1;delete i.showErr,i.lang=i.lang||r.lang;for(l in i)i.hasOwnProperty(l)&&i[l]&&(s=i[l],s=angular.isObject(s)?JSON.stringify(s):s,g.push(encodeURIComponent(l)+"="+encodeURIComponent(s)));g.length&&(o+="?"+g.join("&"));var h={method:u,url:o},m=a.get("jwt");return m&&(h.headers={Authorization:"Bearer "+m}),d&&(h.data=d),t.emit(c+"."+u.toLowerCase()+".start"),e(h).success(function(n){f.resolve(n)}).error(function(n){n?(p&&t.emit("error.api",n),f.reject(n)):f.resolve()})["finally"](function(){t.emit(c+"."+u.toLowerCase()+".end")}),f.promise}return{send:o}}]),angular.module("pancakesAngular").factory("bindHref",["tapTrack","stateHelper",function(n,e){return function(t,r,a,o){var u=r.length&&r[0].localName;"a"===u?a.$set("href",o,t):n.bind(t,r,!0,function(){e.goToUrl(o)})}}]),angular.module("pancakesAngular").factory("casing",function(){function n(n,t){var r=t||["_",".","-"];return e.isArray(r)||(r=[r]),e.each(r,function(e){var t,r,a=n.split(e);for(t=1;t<a.length;t++)r=a[t],a[t]=r.substring(0,1).toUpperCase()+r.substring(1);n=a.join("")}),n}var e=angular;return{camelCase:n}}),angular.module("pancakesAngular").factory("chainPromises",["$q",function(n){return function(e,t){return e&&e.length?e.reduce(n.when,n.when(t)):n.when(t)}}]),angular.module("pancakesAngular").factory("clientAnalytics",["$window","$location","eventBus",function(n,e,t){function r(){var t=n._gaq||[];t.push(["_trackPageview",e.path()])}return n._gaq&&t.on("$stateChangeSuccess",function(){r()}),{captureCurrentPath:r}}]),angular.module("pancakesAngular").factory("clientData",["$window",function(n){function e(n){return t[n]}var t=n.clientData||{};return{get:e}}]),angular.module("pancakesAngular").factory("eventBus",["$document","$rootScope",function(n,e){var t=e.$new(!0);return t.on=t.$on,t.watch=t.$watch,t.emit=function(){e.$broadcast.apply(e,arguments)},t.bindToDocument=function(e,t){n.bind(e,t)},t}]),angular.module("pancakesAngular").factory("clientLogReactor",["eventBus",function(n){function e(n,e){console.log(e+" || "+JSON.stringify(e))}return n.on("log.debug",e),n.on("log.info",e),n.on("log.error",e),n.on("log.critical",e),n.on("error.api",e),n.on("$stateChangeError",function(n,t,r,a,o,u){e({},"State change error: "+u.stack)}),{logToConsole:e}}]),angular.module("pancakesAngular").factory("config",function(){return{staticFiles:{assets:"/"}}}),angular.module("pancakesAngular").factory("extlibs",["$window",function(n){function e(e){return n[e]||{}}return{get:e}}]),angular.module("pancakesAngular").factory("focus",["$timeout","extlibs",function(n,e){function t(e){n(function(){var n=a(e);if(n&&n.length){var t=n.val().length;n[0].focus(),n[0].setSelectionRange(t,t)}},200)}function r(e){n(function(){var n=a(e);n&&n.length&&n[0].blur()},100)}var a=e.get("jQuery");return{set:t,blur:r}}]),function(){function n(n,e,t,r,o){a.directive(n,["i18n","config",function(a,u){function i(n,r,o,i){i="file"===t?u.staticFileRoot+i:a.translate(i,n),"text"===e?r.text(i):"class"===e?o.$addClass(i):o.$set(e,i,n)}return{priority:101,link:function(e,a,u){var c=u[n];if(r)var l=e.$watch(c,function(n){void 0!==n&&null!==n&&(i(e,a,u,n),o&&l&&l())});else if(!r&&null!==t)if(c.indexOf("{{")>=0)var s=u.$observe(n,function(n){i(e,a,u,n),o&&s&&s()});else i(e,a,u,c)}}}])}var e,t,r={src:"file",title:"i18n",placeholder:"i18n",popover:"i18n",value:"i18n",alt:"i18n",text:"i18n",id:null,type:null,"class":null},a=angular.module("pancakesAngular");for(var o in r)r.hasOwnProperty(o)&&(e=o.substring(0,1).toUpperCase()+o.substring(1),"class"!==o&&n("b"+e,o,null,!0,!1),n("bo"+e,o,null,!0,!0),t=r[o],t&&(n("f"+e,o,t,!1,!1),n("fo"+e,o,t,!1,!0),n("bf"+e,o,t,!0,!1),n("bfo"+e,o,t,!0,!0)))}(),angular.module("pancakesAngular").factory("i18n",function(){return{translate:function(n){return n}}}),angular.module("pancakesAngular").factory("initialModel",function(){return{}}),angular.module("pancakesAngular").factory("pageHelper",["casing","routeHelper",function(n,e){var t={},r={};return r.register=function(r,a,o,u){function i(n){return n.routeHelper=e,u(n)}r=n.camelCase(r,"."),a=n.camelCase(a,"."),t[r]=t[r]||{},t[r][a]=t[r][a]||{},t[r][a][o]=i;var c=n.camelCase([o,r,a].join("."),".");this[c]=i,c=n.camelCase([o,a].join("."),"."),this[c]=i,this[o]=function(n,e,r){return t[n][e][o](r)}},r}]),angular.module("pancakesAngular").factory("pageSettings",["$window","$rootElement",function(n,e){function t(t,r){n.document.title=t;var a=angular.element(e.find("meta[name=description]")[0]);a.attr("content",r)}function r(n){var t="gh-"+n.replace(".","-"),r=e.find(".maincontent");r&&r.length&&(r=angular.element(r[0]),r.attr("id",t))}return{updateHead:t,updatePageStyle:r}}]),angular.module("pancakesAngular").factory("queryParams",["_","$timeout","$location","eventBus","stateHelper",function(n,e,t,r,a){var o={};return r.on("$locationChangeSuccess",function(){var u=t.url(),i=u.indexOf("?");if(!(0>i)){var c=u.substring(i+1),l=c.split("&");n.each(l,function(n){var e=n.split("=");o[e[0]]=e[1]}),e(function(){a.removeQueryParams(),o.notify&&r.emit("notify",o.notify)},500)}}),o}]),angular.module("pancakesAngular").factory("routeHelper",function(){return{}}),angular.module("pancakesAngular").factory("safeApply",["$rootScope",function(n){return function(e){var t=n.$root.$$phase;"$apply"===t||"$digest"===t?e&&"function"==typeof e&&e():n.$apply(e)}}]),angular.module("pancakesAngular").factory("serviceHelper",["ajax",function(n){function e(e){return function(t){return n.send(e.url,e.httpMethod,t,e.resourceName)}}function t(n){var t={};for(var r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function r(n){var e=function(n){this.data=n};return e.prototype.save=function(){return this.data&&this.data._id?n.update({data:this.data}):n.create({data:this.data})},angular.extend(e,n),e}return{genServiceMethod:e,genService:t,genModel:r}}]),angular.module("pancakesAngular").factory("stateHelper",["$window","$timeout","$location","_","eventBus",function(n,e,t,r,a){function o(e){if(e){r.isArray(e)&&(e=e.join("/"));var t=0===e.indexOf("http");t||0===e.indexOf("/")||(e="/"+e),n.location.href=e}}function u(n){l=!0,t.replace().url(n),e(function(){l=!1},200)}function i(){u(t.path())}function c(){var n="http://"+t.host(),e=t.port();return 80!==e&&(n+=":"+e),n+=t.url()}var l=!1,s=!1;return a.on("$stateChangeStart",function(n){l&&n.preventDefault()}),a.on("$stateChangeSuccess",function(){n.scrollTo(0,0)}),a.on("$locationChangeStart",function(n){l?s?(n.preventDefault(),s=!1):s=!0:s=!1}),{goToUrl:o,switchUrl:u,removeQueryParams:i,getCurrentUrl:c}}]),angular.module("pancakesAngular").provider("stateLoader",function(){function n(n){for(var e=n.split("."),t="",r=0;r<e.length;r++)t+=e[r].substring(0,1).toUpperCase()+e[r].substring(1);return t}this.loadStates=function(e,t,r){var a={};angular.forEach(t,function(t){angular.forEach(t.urls,function(o,u){var i=r[t.name]||function(){return{}},c=(t.name+(0===u?"":"--"+u)).replace(/\./g,"-"),l={url:o,resolve:{initialModel:i,loadedUser:["activeUser",function(n){return n.init()}]},onEnter:["$rootScope",function(n){n.stateData=t.data||{},n.pageLoadTimestamp=(new Date).getTime()}],views:{"":{controller:n(t.name+"Ctrl"),templateUrl:"templates/"+t.name}}};a[c]&&(c+=(new Date).getTime()),a[c]=!0,e.state(c,l)})})},this.$get=function(){return{getPascalCase:n}}}),angular.module("pancakesAngular").factory("storage",["extlibs","config",function(n,e){function t(n,e,t){if(!n||/^(?:expires|max\-age|path|domain|secure)$/i.test(n))return!1;var r="; expires=Fri, 31 Dec 9999 23:59:59 GMT",a="/",o=!1;s.cookie=encodeURIComponent(n)+"="+encodeURIComponent(e)+r+(t?"; domain="+t:"")+(a?"; path="+a:"")+(o?"; secure":"")}function r(n,e){c.setItem(n,e),t(n,e,l)}function a(n){return n?decodeURIComponent(s.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(n).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null:null}function o(n){return c.getItem(n)||a(n)}function u(n,e){var t="/";s.cookie=encodeURIComponent(n)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(e?"; domain="+e:"")+(t?"; path="+t:"")}function i(n){c.removeItem(n),u(n,l)}var c=n.get("localStorage"),l=e.cookieDomain,s=window.document;return{setCookie:t,set:r,getCookie:a,get:o,removeCookie:u,remove:i}}]),angular.module("pancakesAngular").factory("tapTrack",["$timeout",function(n){function e(e,r,a,o){var u=!1,i=function(){u&&!t?(t=!0,n(function(){t=!1},500),e.$apply(o)):u=!1};r.bind("click",function(n){u=!0,i(),a&&n.preventDefault()}),r.bind("touchstart",function(){u=!0}),r.bind("touchend",function(n){i(),a&&n.preventDefault()}),r.bind("touchmove",function(n){return u=!1,n.stopImmediatePropagation()})}var t=!1;return{bind:e}}]),angular.module("pancakesAngular").factory("tplHelper",["$q","$injector","config","pageSettings","eventBus",function(n,e,t,r,a){function o(n,e){if(e){n.defaults=e;for(var t in e)e.hasOwnProperty(t)&&void 0===n[t]&&(n[t]=e[t])}}function u(n,e,t){if(n&&t){var r=n.presets||t[n.preset]||n.preset&&t[n.type+"."+n.preset]||t[n.type];if(r)for(var a in r)if(r.hasOwnProperty(a)){if(!e||void 0===e[a])throw new Error("No defaults value for "+a+" but in options."+n.preset);n[a]=r[a]}}}function i(n,e){e&&(n.rerenderComponent=function(){e.go(e.current,{},{reload:!0})})}function c(t,r,a,o,u){o&&(u=u||{},t.remodel=function(){var a={currentScope:t,defaults:t.defaults};try{angular.isFunction(o)||angular.isArray(o)&&angular.isFunction(o[o.length-1])?n.when(e.invoke(o,null,a)).then(function(n){angular.forEach(n,function(n,e){if(u[e])throw new Error(r+" model() should not return "+e+" from the parent scope");t[e]=n})}):angular.forEach(o,function(o,i){if("end"!==i){if(u[i])throw new Error(r+" model() should not return "+i+" from the parent scope");angular.isFunction(o)||angular.isArray(o)&&angular.isFunction(o[o.length-1])?n.when(e.invoke(o,null,a)).then(function(n){t[i]=n}):t[i]=o}})}catch(i){throw console.log(r+" has err "),i}},a&&t.remodel())}function l(n,t){for(var r in t)t.hasOwnProperty(r)&&t[r]&&(n[r]=e.invoke(t[r]))}function s(n,t){t&&t.length&&(t.push(function(){var e,r;for(e=0;e<arguments.length;e++)r=arguments[e],n[t[e]]=r}),e.invoke(t))}function f(n){var e=!0;return function(){e?e=!1:n()}}function g(n,e,t){var r,a,o,u;if(e&&t)for(r=0;r<e.length;r++)u=f(t),a=e[r],o=a.charAt(0),"^"===o?n.$watchCollection(a.substring(1),u):"*"===o?n.$watch(a.substring(1),u,!0):n.$watch(a,u)}function d(e){return function(){var t=e.remodel||function(){return!0};n.when(t(e)).then(function(){e.rerenderComponent()})}}function p(n,e){return g(n,e,n.remodel)}function h(n,e){return g(n,e,d(n))}function m(n,e,t){var r,o,u=[];if(e&&t){for(r=0;r<e.length;r++)o=e[r],u.push(a.on(o,t));n.$on("$destroy",function(){for(var n=0;n<u.length;n++)u[n]()})}}function v(n,e){return m(n,e,n.remodel)}function y(n,e){return m(n,e,d(n))}function w(n,e,t){if(angular.extend(n,e),n.pageHead&&n.pageHead.title){var a=n.pageHead.title;r.updateHead(a,n.pageHead.description||a),r.updatePageStyle(t)}}function $(n,t){var r=[];for(var o in t)t.hasOwnProperty(o)&&t[o]&&r.push(a.on(o,e.invoke(t[o])));n.$on("$destroy",function(){for(var n=0;n<r.length;n++)r[n]()})}function k(n,t,r){if(r)for(var a in r)if(r.hasOwnProperty(a)&&r[a]&&(n[a]=e.invoke(r[a]),!angular.isFunction(n[a])))throw new Error(t+" has uiEventHandler "+a+" that does not return a function")}function C(n){e.invoke(n)}return{setDefaults:o,applyPresets:u,generateRerender:i,generateRemodel:c,addValidations:l,attachToScope:s,generateRerenderCallback:d,rerenderOnScopeChange:h,rerenderOnEvent:y,remodelOnScopeChange:p,remodelOnEvent:v,generateScopeChangeHandler:f,doOnScopeChange:g,doOnEvent:m,addInitModel:w,registerListeners:$,addEventHandlers:k,onClientLoad:C}}]);